<!-- Contenedor principal -->
<div class="dolibarr-full-container">
  <!-- Barra superior -->
  <div class="dolibarr-topbar">
    <h2 class="dolibarr-title">Lista de Productos Almacen3</h2>
    <div class="dolibarr-search">
      <input
        type="text"
        [(ngModel)]="filtro"
        placeholder="Buscar producto..."
        (input)="filtrarProductos($event)"
        class="dolibarr-input"
      />
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="dolibarr-main">
    <!-- Sidebar para acciones -->
    <div class="dolibarr-sidebar">
      <h3 class="sidebar-title">Acciones Rápidas</h3>
      <ul class="sidebar-actions">
        <li><button class="sidebar-btn" >Exportar PDF</button></li>
        <li><button class="sidebar-btn" >Exportar Excel</button></li>
      </ul>
    </div>

    <!-- Tabla de productos -->
    <div class="dolibarr-table-wrapper">
      <table class="dolibarr-table">
        <!-- Encabezado -->
        <thead>
          <tr class="dolibarr-header-row">
            <th class="dolibarr-header checkbox-col">
              <input
                type="checkbox"
                [(ngModel)]="todosSeleccionados"
                (change)="toggleSeleccionTodos()"
                class="dolibarr-checkbox"
              />
            </th>
            <th class="dolibarr-header">ID</th>
            <th class="dolibarr-header">Marca</th>
            <th class="dolibarr-header">Nombre</th>
            <th class="dolibarr-header">Categoría</th>
            <th class="dolibarr-header">Subcategoría</th>
            <th class="dolibarr-header">Precio</th>
            <th class="dolibarr-header">Stock</th>
            <th class="dolibarr-header">Proveedor</th>
            <th class="dolibarr-header action-col">Acción</th>
          </tr>
        </thead>

        <!-- Cuerpo -->
        <tbody>
          <tr *ngFor="let producto of productosFiltrados" class="dolibarr-row">
            <!-- Checkbox -->
            <td class="dolibarr-cell checkbox-col">
              <input
                type="checkbox"
                [(ngModel)]="producto.seleccionado"
                class="dolibarr-checkbox"
              />
            </td>
            <!-- ID -->
            <td class="dolibarr-cell">{{ producto.id }}</td>
            <!-- Marca -->
            <td class="dolibarr-cell">{{ producto.marca }}</td>
            <!-- Nombre -->
            <td class="dolibarr-cell">{{ producto.nombre }}</td>
            <!-- Categoría -->
            <td class="dolibarr-cell">{{ producto.categoria }}</td>
            <!-- Subcategoría -->
            <td class="dolibarr-cell">{{ producto.subcategoria }}</td>
            <!-- Precio -->
            <td class="dolibarr-cell">
              <span *ngIf="!producto.editando">{{ producto.precio | currency }}</span>
              <input
                *ngIf="producto.editando"
                type="number"
                [(ngModel)]="producto.precio"
                class="dolibarr-input-sm"
              />
            </td>
            <!-- Stock -->
            <td class="dolibarr-cell">
              <span *ngIf="!producto.editando">{{ producto.stock }}</span>
              <div *ngIf="producto.editando" class="dolibarr-stock-controls">
                <button
                  (click)="producto.stock = producto.stock - 1"
                  class="dolibarr-btn-icon"
                >
                  -
                </button>
                <input
                  type="number"
                  [(ngModel)]="producto.stock"
                  class="dolibarr-input-xs"
                />
                <button
                  (click)="producto.stock = producto.stock + 1"
                  class="dolibarr-btn-icon"
                >
                  +
                </button>
              </div>
            </td>
             



  <td class="dolibarr-cell">
          {{ producto.nombreProveedor ? producto.nombreProveedor + ' - ' + producto.empresa : 'Sin proveedor' }}
        </td>


            
            <!-- Acciones -->
            <td class="dolibarr-cell action-col">
              <div class="dolibarr-actions">
                <button
                  *ngIf="!producto.editando"
                  (click)="editarProducto(producto)"
                  class="dolibarr-btn-edit"
                  title="Editar"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pen-line-icon lucide-pen-line"><path d="M12 20h9"/><path d="M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z"/></svg>
                </button>
                <button
                  *ngIf="producto.editando"
                  (click)="guardarCambios(producto)"
                  class="dolibarr-btn-save"
                  title="Guardar"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check-line-icon lucide-check-line"><path d="M20 4L9 15"/><path d="M21 19L3 19"/><path d="M9 15L4 10"/></svg>
                </button>
                <button
                  (click)="eliminarProductoA3(producto.id)"
                  class="dolibarr-btn-delete"
                  title="Eliminar"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash2-icon lucide-trash-2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Mensaje si no hay productos -->
      <div *ngIf="productosFiltrados.length === 0" class="no-products">
        <p>No hay productos disponibles en Almacén 1.</p>
      </div>

      <!-- Botones de acción inferior -->
      <div class="dolibarr-actions-bottom">
        <label for="ubicacionDestino" class="dolibarr-label">Mover a:</label>
        <select
          id="ubicacionDestino"
          [(ngModel)]="ubicacionSeleccionada"
          class="dolibarr-select"
        >
          <option value="tienda">Tienda</option>
          <option value="almacen1">Almacén 1</option>
          <option value="almacen2">Almacén 2</option>
          <option value="almacen3">Almacén 3</option>
        </select>
        <button
          (click)="moverAlmacenTres(ubicacionSeleccionada)"
          class="dolibarr-btn-primary"
        >
          Mover Seleccionados
        </button>
      </div>
    </div>
  </div>
</div>